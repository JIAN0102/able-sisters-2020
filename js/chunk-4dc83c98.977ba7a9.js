(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dc83c98"],{"0ea8":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"c-steps"},[e("ul",{staticClass:"c-steps__list",class:{"is-step-1":1===t.progress,"is-step-2":2===t.progress,"is-step-3":3===t.progress}},[t._m(0),t._m(1),t._m(2)])])},r=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"c-steps__item"},[e("span"),e("h3",[t._v("訂購明細")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"c-steps__item"},[e("span"),e("h3",[t._v("確認訂單")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"c-steps__item"},[e("span"),e("h3",[t._v("完成訂購")])])}],o=(e("a9e3"),{props:{progress:{type:Number}}}),i=o,c=e("2877"),n=Object(c["a"])(i,s,r,!1,null,null,null);a["a"]=n.exports},"99af":function(t,a,e){"use strict";var s=e("23e7"),r=e("d039"),o=e("e8b5"),i=e("861d"),c=e("7b0b"),n=e("50c4"),l=e("8418"),u=e("65f0"),d=e("1dde"),p=e("b622"),m=e("2d00"),v=p("isConcatSpreadable"),_=9007199254740991,f="Maximum allowed index exceeded",g=m>=51||!r((function(){var t=[];return t[v]=!1,t.concat()[0]!==t})),h=d("concat"),C=function(t){if(!i(t))return!1;var a=t[v];return void 0!==a?!!a:o(t)},b=!g||!h;s({target:"Array",proto:!0,forced:b},{concat:function(t){var a,e,s,r,o,i=c(this),d=u(i,0),p=0;for(a=-1,s=arguments.length;a<s;a++)if(o=-1===a?i:arguments[a],C(o)){if(r=n(o.length),p+r>_)throw TypeError(f);for(e=0;e<r;e++,p++)e in o&&l(d,p,o[e])}else{if(p>=_)throw TypeError(f);l(d,p++,o)}return d.length=p,d}})},e9fe:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("main",[e("Loading",{attrs:{isLoading:t.isLoading}}),e("Steps",{attrs:{progress:1}}),e("div",{staticClass:"c-cart"},[e("div",{staticClass:"l-wrapper-tiny"},[e("div",{staticClass:"c-cart__section"},[t._m(0),t.carts.length?e("div",{staticClass:"c-table"},[t._m(1),e("ul",{staticClass:"c-table__list"},t._l(t.carts,(function(a){return e("li",{key:a.id,staticClass:"c-table__item"},[e("div",{staticClass:"col-row"},[e("div",{staticClass:"col-1/3@md"},[e("div",{staticClass:"c-table__box",attrs:{"data-title":"商品名稱"}},[e("img",{staticClass:"u-mr-2",attrs:{src:a.product.imageUrl[0],alt:a.product.title}}),e("span",[t._v(t._s(a.product.title))])])]),e("div",{staticClass:"col-1/3@md"},[e("div",{staticClass:"c-table__box",attrs:{"data-title":"數量"}},[e("div",{staticClass:"p-product-detail__action"},[e("button",{staticClass:"p-product-detail__btn p-product-detail__btn-minus",attrs:{disabled:1===a.quantity},on:{click:function(e){return t.updateQuantity(a,-1)}}}),e("div",{staticClass:"p-product-detail__input"},[t._v(t._s(a.quantity))]),e("button",{staticClass:"p-product-detail__btn p-product-detail__btn-plus",on:{click:function(e){return t.updateQuantity(a,1)}}})])])]),e("div",{staticClass:"col-1/3@md"},[e("div",{staticClass:"c-table__box",attrs:{"data-title":"單價"}},[e("span",[t._v(t._s(t._f("currency")(a.product.price)))])])])]),e("button",{staticClass:"c-table__remove",attrs:{type:"button"},on:{click:function(e){return t.removeCart(a.product.id)}}})])})),0),e("div",{staticClass:"c-table__coupon"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.couponCode},on:{input:function(a){a.target.composing||(t.couponCode=a.target.value)}}}),e("button",{attrs:{type:"button"},on:{click:t.addCoupon}},[t._v(" 套用 ")])]),e("div",{staticClass:"c-table__total"},[e("p",[t._v(" 總計 "),e("span",{staticClass:"u-color-primary"},[t._v(t._s(t._f("currency")(t.cartTotal)))])]),t.coupon.enabled?e("p",[t._v(" 折扣價 "),e("span",{staticClass:"u-color-primary"},[t._v(" "+t._s(t._f("currency")(t.cartTotal*(t.coupon.percent/100)))+" ")])]):t._e()])]):e("div",{staticClass:"c-cart__remind"},[e("p",{staticClass:"u-color-gray-400"},[t._v("目前購物車沒有任何商品")])])]),e("div",{staticClass:"c-cart__section"},[t._m(2),e("ValidationObserver",{staticClass:"c-form",attrs:{tag:"div"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.invalid;return[e("form",{on:{submit:function(a){return a.preventDefault(),t.sendOrder(a)}}},[e("ValidationProvider",{staticClass:"c-form__group",attrs:{tag:"div",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors,r=a.classes;return[e("label",{attrs:{for:"username"}},[t._v("收件人姓名")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"c-form__control",class:r,attrs:{type:"text",id:"username",name:"收件人姓名"},domProps:{value:t.form.name},on:{input:function(a){a.target.composing||t.$set(t.form,"name",a.target.value)}}}),e("span",{staticClass:"c-form__error"},[t._v(t._s(s[0]))])]}}],null,!0)}),e("ValidationProvider",{staticClass:"c-form__group",attrs:{tag:"div",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors,r=a.classes;return[e("label",{attrs:{for:"email"}},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"c-form__control",class:r,attrs:{type:"email",id:"email",name:"Email"},domProps:{value:t.form.email},on:{input:function(a){a.target.composing||t.$set(t.form,"email",a.target.value)}}}),e("span",{staticClass:"c-form__error"},[t._v(t._s(s[0]))])]}}],null,!0)}),e("ValidationProvider",{staticClass:"c-form__group",attrs:{tag:"div",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors,r=a.classes;return[e("label",{attrs:{for:"tel"}},[t._v("電話")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.tel,expression:"form.tel"}],staticClass:"c-form__control",class:r,attrs:{type:"text",id:"tel",name:"電話"},domProps:{value:t.form.tel},on:{input:function(a){a.target.composing||t.$set(t.form,"tel",a.target.value)}}}),e("span",{staticClass:"c-form__error"},[t._v(t._s(s[0]))])]}}],null,!0)}),e("ValidationProvider",{staticClass:"c-form__group",attrs:{tag:"div",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(a){var s=a.errors,r=a.classes;return[e("label",{attrs:{for:"address"}},[t._v("地址")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.address,expression:"form.address"}],staticClass:"c-form__control",class:r,attrs:{type:"text",id:"address",name:"地址"},domProps:{value:t.form.address},on:{input:function(a){a.target.composing||t.$set(t.form,"address",a.target.value)}}}),e("span",{staticClass:"c-form__error"},[t._v(t._s(s[0]))])]}}],null,!0)}),e("ValidationProvider",{staticClass:"c-form__group",attrs:{tag:"div",rules:"required"}},[e("label",[t._v("購買方式")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.payment,expression:"form.payment"}],staticClass:"c-form__control",attrs:{required:""},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.form,"payment",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("請選擇付款方式")]),e("option",{attrs:{value:"WebATM"}},[t._v("WebATM")]),e("option",{attrs:{value:"ATM"}},[t._v("ATM")]),e("option",{attrs:{value:"CVS"}},[t._v("CVS")]),e("option",{attrs:{value:"Barcode"}},[t._v("Barcode")]),e("option",{attrs:{value:"Credit"}},[t._v("Credit")]),e("option",{attrs:{value:"ApplePay"}},[t._v("ApplePay")]),e("option",{attrs:{value:"GooglePay"}},[t._v("GooglePay")])])]),e("ValidationProvider",{staticClass:"c-form__group",attrs:{tag:"div"}},[e("label",{attrs:{for:"message"}},[t._v("留言")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"c-form__control",attrs:{id:"message"},domProps:{value:t.form.message},on:{input:function(a){a.target.composing||t.$set(t.form,"message",a.target.value)}}})]),e("div",{staticClass:"u-mt-10 u-text-right"},[e("button",{staticClass:"c-btn c-btn--primary",attrs:{type:"submit",disabled:s}},[t._v(" 送出訂單 ")])])],1)]}}])})],1)])])],1)},r=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"u-mb-8 u-text-center"},[e("h2",{staticClass:"u-text-xl u-font-medium"},[t._v("購物車內容")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"c-table__header"},[e("div",{staticClass:"col-row"},[e("div",{staticClass:"col-1/3@md"},[e("div",{staticClass:"c-table__box"},[e("span",[t._v("商品名稱")])])]),e("div",{staticClass:"col-1/3@md"},[e("div",{staticClass:"c-table__box"},[e("span",[t._v("數量")])])]),e("div",{staticClass:"col-1/3@md"},[e("div",{staticClass:"c-table__box"},[e("span",[t._v("單價")])])])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"u-mb-8 u-text-center"},[e("h2",{staticClass:"u-text-xl u-font-medium"},[t._v("購買資訊")])])}],o=(e("99af"),e("4160"),e("159b"),e("0ea8")),i={components:{Steps:o["a"]},data:function(){return{isLoading:!1,carts:[],cartTotal:0,coupon:{},couponCode:"",form:{name:"",email:"",tel:"",address:"",payment:"",message:""}}},created:function(){this.getCart()},methods:{getCart:function(){var t=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/api","/").concat("9581c775-21da-48b3-9520-2da056c30643","/ec/shopping");this.$http.get(a).then((function(a){t.carts=a.data.data,t.cartTotal=0,t.carts.forEach((function(a){t.cartTotal+=a.product.price*a.quantity})),t.isLoading=!1})).catch((function(){}))},removeCart:function(t){var a=this;this.isLoading=!0;var e="".concat("https://course-ec-api.hexschool.io/api","/").concat("9581c775-21da-48b3-9520-2da056c30643","/ec/shopping/").concat(t);this.$http.delete(e).then((function(t){a.isLoading=!1,a.getCart();var e=t.data.message;a.$bus.$emit("get-cart"),a.$bus.$emit("message",e,"success")})).catch((function(){a.isLoading=!1}))},updateQuantity:function(t,a){var e=this;this.isLoading=!0;var s=t.quantity+a,r="".concat("https://course-ec-api.hexschool.io/api","/").concat("9581c775-21da-48b3-9520-2da056c30643","/ec/shopping"),o={product:t.product.id,quantity:s};this.$http.patch(r,o).then((function(){e.isLoading=!1,e.getCart()})).catch((function(t){e.$bus.$emit("message",t.response.data.message,"danger")}))},addCoupon:function(){var t=this;if(this.couponCode){this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/api","/").concat("9581c775-21da-48b3-9520-2da056c30643","/ec/coupon/search");this.$http.post(a,{code:this.couponCode}).then((function(a){t.coupon=a.data.data,t.isLoading=!1})).catch((function(a){t.$bus.$emit("message",a.response.data.message,"danger"),t.isLoading=!1}))}},sendOrder:function(){var t=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/api","/").concat("9581c775-21da-48b3-9520-2da056c30643","/ec/orders"),e=JSON.parse(JSON.stringify(this.form));this.coupon.enabled&&(e.coupon=this.couponCode),this.$http.post(a,e).then((function(a){a.data.data.id&&t.$router.push("/checkout/".concat(a.data.data.id)),t.isLoading=!1})).catch((function(a){t.$bus.$emit("message",a.response.data.message,"danger"),t.isLoading=!1}))}}},c=i,n=e("2877"),l=Object(n["a"])(c,s,r,!1,null,null,null);a["default"]=l.exports}}]);
//# sourceMappingURL=chunk-4dc83c98.977ba7a9.js.map